(function(){'use strict';function a(a,b){for(var e,f=[],g=0,h=0,i='',j=b&&b.delimiter||u,l=b&&b.delimiters||v,n=!1;null!==(e=w.exec(a));){var o=e[0],m=e[1],p=e.index;if(i+=a.slice(h,p),h=p+o.length,m){i+=m[1],n=!0;continue}var q='',r=a[h],s=e[2],t=e[3],x=e[4],y=e[5];if(!n&&i.length){var z=i.length-1;-1<l.indexOf(i[z])&&(q=i[z],i=i.slice(0,z))}i&&(f.push(i),i='',n=!1);var k=''!==q&&void 0!==r&&r!==q,A=q||j,B=t||x;f.push({name:s||g++,prefix:q,delimiter:A,optional:'?'===y||'*'===y,repeat:'+'===y||'*'===y,partial:k,pattern:B?d(B):'[^'+c(A)+']+?'})}return(i||h<a.length)&&f.push(i+a.substr(h)),f}function b(a){for(var b=Array(a.length),c=0;c<a.length;c++)'object'==typeof a[c]&&(b[c]=new RegExp('^(?:'+a[c].pattern+')$'));return function(c,d){for(var e,f='',g=d&&d.encode||encodeURIComponent,h=0;h<a.length;h++){if(e=a[h],'string'==typeof e){f+=e;continue}var i,k=c?c[e.name]:void 0;if(Array.isArray(k)){if(!e.repeat)throw new TypeError('Expected "'+e.name+'" to not repeat, but got array');if(0===k.length){if(e.optional)continue;throw new TypeError('Expected "'+e.name+'" to not be empty')}for(var l=0;l<k.length;l++){if(i=g(k[l],e),!b[h].test(i))throw new TypeError('Expected all "'+e.name+'" to match "'+e.pattern+'"');f+=(0===l?e.prefix:e.delimiter)+i}continue}if('string'==typeof k||'number'==typeof k||'boolean'==typeof k){if(i=g(k+'',e),!b[h].test(i))throw new TypeError('Expected "'+e.name+'" to match "'+e.pattern+'", but got "'+i+'"');f+=e.prefix+i;continue}if(e.optional){e.partial&&(f+=e.prefix);continue}throw new TypeError('Expected "'+e.name+'" to be '+(e.repeat?'an array':'a string'))}return f}}function c(a){return a.replace(/([.+*?=^!:${}()[\]|/\\])/g,'\\$1')}function d(a){return a.replace(/([=!:$/()])/g,'\\$1')}function e(a){return a&&a.sensitive?'':'i'}function f(a,b){if(!b)return a;var c=a.source.match(/\((?!\?)/g);if(c)for(var d=0;d<c.length;d++)b.push({name:d,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,pattern:null});return a}function g(a,b,c){for(var d=[],f=0;f<a.length;f++)d.push(j(a[f],b,c).source);return new RegExp('(?:'+d.join('|')+')',e(c))}function h(b,c,d){return i(a(b,d),c,d)}function i(a,b,d){d=d||{};for(var f,g=d.strict,h=!1!==d.end,j=c(d.delimiter||u),k=d.delimiters||v,l=[].concat(d.endsWith||[]).map(c).concat('$').join('|'),m='',n=0===a.length,o=0;o<a.length;o++)if(f=a[o],'string'==typeof f)m+=c(f),n=o===a.length-1&&-1<k.indexOf(f[f.length-1]);else{var i=c(f.prefix),p=f.repeat?'(?:'+f.pattern+')(?:'+i+'(?:'+f.pattern+'))*':f.pattern;b&&b.push(f),m+=f.optional?f.partial?i+'('+p+')?':'(?:'+i+'('+p+'))?':i+'('+p+')'}return h?(!g&&(m+='(?:'+j+')?'),m+='$'===l?'$':'(?='+l+')'):(!g&&(m+='(?:'+j+'(?='+l+'))?'),!n&&(m+='(?='+j+'|'+l+')')),new RegExp('^'+m,e(d))}function j(a,b,c){return a instanceof RegExp?f(a,b):Array.isArray(a)?g(a,b,c):h(a,b,c)}function k(a){return{func:a,type:'request'}}function l(a){return{func:a,type:'any'}}function m(a){return{func(b){b.waitUntil(a(b))},type:'response'}}function n(a){return{func:a,type:'conditional'}}function o(a){const b=[],c=t(a,b,{strict:!0,sensitive:!0});return n((d)=>{const e=d.url;let f;if('string'==typeof a&&a.startsWith('/')){if(e.origin!=location.origin)return!1;f=e.pathname}else f=`${e.protocol}//${e.host.replace(/:/g,'\\:')}${e.pathname}`;const g=c.exec(f);return!!g&&(d.params||(d.params={}),g.slice(1).forEach((a,c)=>{d.params[b[c].name]=a}),!0)})}function p(a){return n(({request:b})=>b.method===a)}function q(a){return function(b,...c){const d=new y;d.add(p(a)),d.all(...c),this.add(d)}}function r(a){return new Promise((b)=>setTimeout(b,a))}function s(...a){const b=new y;return b.add(...a),b}var t=j,u='/',v='./',w=new RegExp('(\\\\.)|(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?','g');t.parse=a,t.compile=function(c,d){return b(a(c,d))},t.tokensToFunction=b,t.tokensToRegExp=i;class x{constructor(a){if(this.request=a.request,this.preloadResponse=a.preloadResponse,this.clientId=a.clientId,a instanceof x){this.url=a.url,this.params=a.params,this.waitUntil=a.waitUntil;for(const[b,c]of Object.entries(a))b in this||(this[b]=c)}else this.url=new URL(a.request.url),this.waitUntil=a.waitUntil.bind(a)}}class y{constructor(){this._handlers=[]}add(...a){this._handlers.push(...a.map((a)=>{return'function'==typeof a?k(a):a}))}all(a,...b){const c=new y;'string'==typeof a?c.add(o(a)):c.add(a),c.add(...b),this.add(c)}async handle(a){a instanceof FetchEvent&&(a=new x(a));for(const b of this._handlers)try{if(b instanceof y){a.response=(await b.handle(a))||a.response,a.error=void 0;continue}switch(b.type){case'any':if(a.error)continue;a.response=(await b.func(a))||a.response;break;case'conditional':if(a.error)continue;if(!1==(await b.func(a)))return a.response;break;case'request':if(a.response||a.error)continue;a.response=(await b.func(a))||void 0;break;case'response':if(a.error||!a.response)continue;a.response=(await b.func(a))||a.response;break;case'error':if(!a.error)continue;a.response=(await b.func(a))||a.response,a.error=void 0;}}catch(b){a.error=b}if(a.error)throw a.error;return a.response}addFetchListener(){self.addEventListener('fetch',(a)=>{a.respondWith(this.handle(a).then((b)=>b||fetch(a.request)))})}}y.prototype.get=q('GET'),y.prototype.put=q('PUT'),y.prototype.post=q('POST'),y.prototype.delete=q('DELETE');const z=new WeakMap;var A=Object.freeze({fromCache:function(a,b){let c;return a instanceof Request||'string'==typeof a?c=a:b=a,k(async({request:a})=>{const d=await caches.match(c||a,b);return d&&z.set(d,!0),d})},fromNetwork:function({timeout:a=0}={}){return k(({request:b})=>{const c=fetch(b).catch(()=>null);return a?Promise.race([c,r(a)]):c})},fromPreload:function(){return k(({preloadResponse:a})=>a)},ifMethod:p,ifNavigation:function(){return n(({request:a})=>'navigate'==a.mode)},ifUrl:o,race:function(...a){const b=a.map((a)=>{return a instanceof y?a:s(a)});return l((a)=>{return new Promise((c,d)=>{const e=b.map(async(b)=>{const d=new x(a),e=await b.handle(d);e&&c(e)});Promise.all(e).then(()=>c(),d)})})},sequence:s,toCache:function(a){return m(async({response:b,request:c})=>{if(!z.get(b)&&b.ok){const d=b.clone(),e=await caches.open(a);await e.put(c,d)}})},updateCache:function(a){return m(async({response:b,request:c})=>{const d=b.clone(),e=await caches.open(a);return z.get(b)?void(await e.add(c)):void(!b.ok||(await e.put(c,d)))})},wait:function(a){return l(()=>r(a))}}),B=Object.freeze({requestHandler:k,responseHandler:function(a){return{func:a,type:'response'}},anyHandler:l,responseWaitUntilHandler:m,waitUntilHandler:function(a){return{func(b){b.waitUntil(a(b))},type:'any'}},errorHandler:function(a){return{func:a,type:'error'}},conditionalHandler:n});y.handlers=A,y.handlerTypes=B,self.Router=y})();
