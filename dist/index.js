(function(){'use strict';function a(a,b){for(var c,d=[],g=0,h=0,i='',j=b&&b.delimiter||'/';null!=(c=w.exec(a));){var k=c[0],l=c[1],m=c.index;if(i+=a.slice(h,m),h=m+k.length,l){i+=l[1];continue}var n=a[h],o=c[2],p=c[3],q=c[4],r=c[5],s=c[6],t=c[7];i&&(d.push(i),i='');var u=c[2]||j,v=q||r;d.push({name:p||g++,prefix:o||'',delimiter:u,optional:'?'===s||'*'===s,repeat:'+'===s||'*'===s,partial:null!=o&&null!=n&&n!==o,asterisk:!!t,pattern:v?f(v):t?'.*':'[^'+e(u)+']+?'})}return h<a.length&&(i+=a.substr(h)),i&&d.push(i),d}function b(a){return encodeURI(a).replace(/[\/?#]/g,function(a){return'%'+a.charCodeAt(0).toString(16).toUpperCase()})}function c(a){return encodeURI(a).replace(/[?#]/g,function(a){return'%'+a.charCodeAt(0).toString(16).toUpperCase()})}function d(a){for(var d=Array(a.length),e=0;e<a.length;e++)'object'==typeof a[e]&&(d[e]=new RegExp('^(?:'+a[e].pattern+')$'));return function(e,f){for(var g,h='',k=e||{},l=f||{},m=l.pretty?b:encodeURIComponent,n=0;n<a.length;n++){if(g=a[n],'string'==typeof g){h+=g;continue}var i,o=k[g.name];if(null==o)if(g.optional){g.partial&&(h+=g.prefix);continue}else throw new TypeError('Expected "'+g.name+'" to be defined');if(u(o)){if(!g.repeat)throw new TypeError('Expected "'+g.name+'" to not repeat, but received `'+JSON.stringify(o)+'`');if(0===o.length)if(g.optional)continue;else throw new TypeError('Expected "'+g.name+'" to not be empty');for(var p=0;p<o.length;p++){if(i=m(o[p]),!d[n].test(i))throw new TypeError('Expected all "'+g.name+'" to match "'+g.pattern+'", but received `'+JSON.stringify(i)+'`');h+=(0===p?g.prefix:g.delimiter)+i}continue}if(i=g.asterisk?c(o):m(o),!d[n].test(i))throw new TypeError('Expected "'+g.name+'" to match "'+g.pattern+'", but received "'+i+'"');h+=g.prefix+i}return h}}function e(a){return a.replace(/([.+*?=^!:${}()[\]|\/\\])/g,'\\$1')}function f(a){return a.replace(/([=!:$\/()])/g,'\\$1')}function g(a,b){return a.keys=b,a}function h(a){return a.sensitive?'':'i'}function i(a,b){var c=a.source.match(/\((?!\?)/g);if(c)for(var d=0;d<c.length;d++)b.push({name:d,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return g(a,b)}function j(a,b,c){for(var d=[],e=0;e<a.length;e++)d.push(m(a[e],b,c).source);var f=new RegExp('(?:'+d.join('|')+')',h(c));return g(f,b)}function k(b,c,d){return l(a(b,d),c,d)}function l(a,b,c){u(b)||(c=b||c,b=[]),c=c||{};for(var d,f=c.strict,j=!1!==c.end,k='',l=0;l<a.length;l++)if(d=a[l],'string'==typeof d)k+=e(d);else{var i=e(d.prefix),m='(?:'+d.pattern+')';b.push(d),d.repeat&&(m+='(?:'+i+m+')*'),m=d.optional?d.partial?i+'('+m+')?':'(?:'+i+'('+m+'))?':i+'('+m+')',k+=m}var n=e(c.delimiter||'/'),o=k.slice(-n.length)===n;return f||(k=(o?k.slice(0,-n.length):k)+'(?:'+n+'(?=$))?'),k+=j?'$':f&&o?'':'(?='+n+'|$)',g(new RegExp('^'+k,h(c)),b)}function m(a,b,c){return u(b)||(c=b||c,b=[]),c=c||{},a instanceof RegExp?i(a,b):u(a)?j(a,b,c):k(a,b,c)}function n(a){return{handler:a,type:'request'}}function o(a){return{handler(b){b.waitUntil(a(b))},type:'response'}}function p(a){return{handler:a,type:'conditional'}}function q(a){const b=[],c=v(a,b,{strict:!0,sensitive:!0});return p((d)=>{const e=d.url;let f;if('string'==typeof a&&a.startsWith('/')){if(e.origin!=location.origin)return!1;f=e.pathname}else f=`${e.protocol}//${e.host.replace(/:/g,'\\:')}${e.pathname}`;const g=c.exec(f);return!!g&&(d.params||(d.params={}),g.slice(1).forEach((a,c)=>{d.params[b[c].name]=a}),!0)})}function r(a){return p(({request:b})=>b.method===a)}function s(a){return function(b,...c){const d=new y;d.add(r(a)),d.all(...c),this.add(d)}}function t(a){return new Promise((b)=>setTimeout(b,a))}var u=Array.isArray||function(a){return'[object Array]'==Object.prototype.toString.call(a)},v=m,w=new RegExp('(\\\\.)|([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))','g');v.parse=a,v.compile=function(b,c){return d(a(b,c))},v.tokensToFunction=d,v.tokensToRegExp=l;class x{constructor(a){this.request=a.request,this.preloadResponse=a.preloadResponse,this.clientId=a.clientId,this.url=new URL(a.request.url),this.waitUntil=a.waitUntil.bind(a)}}class y{constructor(){this._items=[]}add(...a){this._items.push(...a.map((a)=>{return'function'==typeof a?n(a):a}))}all(a,...b){const c=new y;'string'==typeof a?c.add(q(a)):c.add(a),c.add(...b),this.add(c)}async handle(a){a instanceof FetchEvent&&(a=new x(a));for(const b of this._items)try{if(b instanceof y){a.response=(await b.handle(a))||a.response,a.error=null;continue}switch(b.type){case'finally':await b.handler(a);break;case'conditional':if(a.error)continue;if(!1==(await b.handler(a)))return a.response;break;case'request':if(a.response||a.error)continue;a.response=(await b.handler(a))||null;break;case'response':if(a.error||!a.response)continue;a.response=(await b.handler(a))||a.response;break;case'error':if(!a.error)continue;a.response=(await b.handler(a))||a.response,a.error=null;}}catch(b){a.error=b}if(a.error)throw a.error;return a.response}addFetchListener(){self.addEventListener('fetch',(a)=>{a.respondWith(this.handle(a).then((b)=>b||fetch(a.request)))})}}y.prototype.get=s('GET'),y.prototype.put=s('PUT'),y.prototype.post=s('POST'),y.prototype.delete=s('DELETE');const z=new WeakMap;var A=Object.freeze({fromCache:function(a,b){let c;return a instanceof Request||'string'==typeof a?c=a:b=a,n(async({request:a})=>{const d=await caches.match(c||a,b);return d&&z.set(d,!0),d})},fromNetwork:function({timeout:a=0}={}){return n(({request:b})=>{const c=fetch(b).catch(()=>null);return a?Promise.race([c,t(a)]):c})},fromPreload:function(){return n(({preloadResponse:a})=>a)},ifMethod:r,ifNavigation:function(){return p(({request:a})=>'navigate'==a.mode)},ifUrl:q,toCache:function(a){return o(async({response:b,request:c})=>{if(!z.get(b)&&b.ok){const d=b.clone(),e=await caches.open(a);await e.put(c,d)}})},updateCache:function(a){return o(async({response:b,request:c})=>{const d=b.clone(),e=await caches.open(a);return z.get(b)?void(await e.add(c)):void(!b.ok||(await e.put(c,d)))})}});y.handlers=A,self.Router=y})();
