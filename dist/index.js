(function(){'use strict';function a(a,b){for(var c,d=[],g=0,h=0,i='',j=b&&b.delimiter||'/';null!=(c=y.exec(a));){var k=c[0],l=c[1],m=c.index;if(i+=a.slice(h,m),h=m+k.length,l){i+=l[1];continue}var n=a[h],o=c[2],p=c[3],q=c[4],r=c[5],s=c[6],t=c[7];i&&(d.push(i),i='');var u=c[2]||j,v=q||r;d.push({name:p||g++,prefix:o||'',delimiter:u,optional:'?'===s||'*'===s,repeat:'+'===s||'*'===s,partial:null!=o&&null!=n&&n!==o,asterisk:!!t,pattern:v?f(v):t?'.*':'[^'+e(u)+']+?'})}return h<a.length&&(i+=a.substr(h)),i&&d.push(i),d}function b(a){return encodeURI(a).replace(/[\/?#]/g,function(a){return'%'+a.charCodeAt(0).toString(16).toUpperCase()})}function c(a){return encodeURI(a).replace(/[?#]/g,function(a){return'%'+a.charCodeAt(0).toString(16).toUpperCase()})}function d(a){for(var d=Array(a.length),e=0;e<a.length;e++)'object'==typeof a[e]&&(d[e]=new RegExp('^(?:'+a[e].pattern+')$'));return function(e,f){for(var g,h='',k=e||{},l=f||{},m=l.pretty?b:encodeURIComponent,n=0;n<a.length;n++){if(g=a[n],'string'==typeof g){h+=g;continue}var i,o=k[g.name];if(null==o)if(g.optional){g.partial&&(h+=g.prefix);continue}else throw new TypeError('Expected "'+g.name+'" to be defined');if(w(o)){if(!g.repeat)throw new TypeError('Expected "'+g.name+'" to not repeat, but received `'+JSON.stringify(o)+'`');if(0===o.length)if(g.optional)continue;else throw new TypeError('Expected "'+g.name+'" to not be empty');for(var p=0;p<o.length;p++){if(i=m(o[p]),!d[n].test(i))throw new TypeError('Expected all "'+g.name+'" to match "'+g.pattern+'", but received `'+JSON.stringify(i)+'`');h+=(0===p?g.prefix:g.delimiter)+i}continue}if(i=g.asterisk?c(o):m(o),!d[n].test(i))throw new TypeError('Expected "'+g.name+'" to match "'+g.pattern+'", but received "'+i+'"');h+=g.prefix+i}return h}}function e(a){return a.replace(/([.+*?=^!:${}()[\]|\/\\])/g,'\\$1')}function f(a){return a.replace(/([=!:$\/()])/g,'\\$1')}function g(a,b){return a.keys=b,a}function h(a){return a.sensitive?'':'i'}function i(a,b){var c=a.source.match(/\((?!\?)/g);if(c)for(var d=0;d<c.length;d++)b.push({name:d,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return g(a,b)}function j(a,b,c){for(var d=[],e=0;e<a.length;e++)d.push(m(a[e],b,c).source);var f=new RegExp('(?:'+d.join('|')+')',h(c));return g(f,b)}function k(b,c,d){return l(a(b,d),c,d)}function l(a,b,c){w(b)||(c=b||c,b=[]),c=c||{};for(var d,f=c.strict,j=!1!==c.end,k='',l=0;l<a.length;l++)if(d=a[l],'string'==typeof d)k+=e(d);else{var i=e(d.prefix),m='(?:'+d.pattern+')';b.push(d),d.repeat&&(m+='(?:'+i+m+')*'),m=d.optional?d.partial?i+'('+m+')?':'(?:'+i+'('+m+'))?':i+'('+m+')',k+=m}var n=e(c.delimiter||'/'),o=k.slice(-n.length)===n;return f||(k=(o?k.slice(0,-n.length):k)+'(?:'+n+'(?=$))?'),k+=j?'$':f&&o?'':'(?='+n+'|$)',g(new RegExp('^'+k,h(c)),b)}function m(a,b,c){return w(b)||(c=b||c,b=[]),c=c||{},a instanceof RegExp?i(a,b):w(a)?j(a,b,c):k(a,b,c)}function n(a){return{func:a,type:'request'}}function o(a){return{func:a,type:'any'}}function p(a){return{func(b){b.waitUntil(a(b))},type:'response'}}function q(a){return{func:a,type:'conditional'}}function r(a){const b=[],c=x(a,b,{strict:!0,sensitive:!0});return q((d)=>{const e=d.url;let f;if('string'==typeof a&&a.startsWith('/')){if(e.origin!=location.origin)return!1;f=e.pathname}else f=`${e.protocol}//${e.host.replace(/:/g,'\\:')}${e.pathname}`;const g=c.exec(f);return!!g&&(d.params||(d.params={}),g.slice(1).forEach((a,c)=>{d.params[b[c].name]=a}),!0)})}function s(a){return q(({request:b})=>b.method===a)}function t(a){return function(b,...c){const d=new A;d.add(s(a)),d.all(...c),this.add(d)}}function u(a){return new Promise((b)=>setTimeout(b,a))}function v(...a){const b=new A;return b.add(...a),b}var w=Array.isArray||function(a){return'[object Array]'==Object.prototype.toString.call(a)},x=m,y=new RegExp('(\\\\.)|([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))','g');x.parse=a,x.compile=function(b,c){return d(a(b,c))},x.tokensToFunction=d,x.tokensToRegExp=l;class z{constructor(a){if(this.request=a.request,this.preloadResponse=a.preloadResponse,this.clientId=a.clientId,a instanceof z){this.url=a.url,this.params=a.params,this.waitUntil=a.waitUntil;for(const[b,c]of Object.entries(a))b in this||(this[b]=c)}else this.url=new URL(a.request.url),this.waitUntil=a.waitUntil.bind(a)}}class A{constructor(){this._handlers=[]}add(...a){this._handlers.push(...a.map((a)=>{return'function'==typeof a?n(a):a}))}all(a,...b){const c=new A;'string'==typeof a?c.add(r(a)):c.add(a),c.add(...b),this.add(c)}async handle(a){a instanceof FetchEvent&&(a=new z(a));for(const b of this._handlers)try{if(b instanceof A){a.response=(await b.handle(a))||a.response,a.error=null;continue}switch(b.type){case'any':if(a.error)continue;a.response=(await b.func(a))||a.response;break;case'conditional':if(a.error)continue;if(!1==(await b.func(a)))return a.response;break;case'request':if(a.response||a.error)continue;a.response=(await b.func(a))||null;break;case'response':if(a.error||!a.response)continue;a.response=(await b.func(a))||a.response;break;case'error':if(!a.error)continue;a.response=(await b.func(a))||a.response,a.error=null;}}catch(b){a.error=b}if(a.error)throw a.error;return a.response}addFetchListener(){self.addEventListener('fetch',(a)=>{a.respondWith(this.handle(a).then((b)=>b||fetch(a.request)))})}}A.prototype.get=t('GET'),A.prototype.put=t('PUT'),A.prototype.post=t('POST'),A.prototype.delete=t('DELETE');const B=new WeakMap;var C=Object.freeze({fromCache:function(a,b){let c;return a instanceof Request||'string'==typeof a?c=a:b=a,n(async({request:a})=>{const d=await caches.match(c||a,b);return d&&B.set(d,!0),d})},fromNetwork:function({timeout:a=0}={}){return n(({request:b})=>{const c=fetch(b).catch(()=>null);return a?Promise.race([c,u(a)]):c})},fromPreload:function(){return n(({preloadResponse:a})=>a)},ifMethod:s,ifNavigation:function(){return q(({request:a})=>'navigate'==a.mode)},ifUrl:r,race:function(...a){const b=a.map((a)=>{return a instanceof A?a:v(a)});return o((a)=>{return new Promise((c,d)=>{const e=b.map(async(b)=>{const d=new z(a),e=await b.handle(d);e&&c(e)});Promise.all(e).then(()=>c(),d)})})},sequence:v,toCache:function(a){return p(async({response:b,request:c})=>{if(!B.get(b)&&b.ok){const d=b.clone(),e=await caches.open(a);await e.put(c,d)}})},updateCache:function(a){return p(async({response:b,request:c})=>{const d=b.clone(),e=await caches.open(a);return B.get(b)?void(await e.add(c)):void(!b.ok||(await e.put(c,d)))})},wait:function(a){return o(()=>u(a))}}),D=Object.freeze({requestHandler:n,responseHandler:function(a){return{func:a,type:'response'}},anyHandler:o,responseWaitUntilHandler:p,waitUntilHandler:function(a){return{func(b){b.waitUntil(a(b))},type:'any'}},errorHandler:function(a){return{func:a,type:'error'}},conditionalHandler:q});A.handlers=C,A.handlerTypes=D,self.Router=A})();
